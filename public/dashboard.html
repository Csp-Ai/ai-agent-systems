<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Hybrid Dancers AI Agent System</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    header { text-align: center; margin-bottom: 20px; }
    h1 { margin-bottom: 0; }
    #agent-list { list-style: none; padding: 0; }
    #agent-list li { margin-bottom: 6px; }
    pre { background: #f4f4f4; padding: 10px; overflow-x: auto; }
    button { margin-right: 10px; padding: 6px 12px; }
  </style>
</head>
<body>
  <header>
    <h1>Hybrid Dancers AI Agent System</h1>
    <p>Live deployment overview and agent status</p>
  </header>
  <section id="deployment">
    <h2>Latest Deployment</h2>
    <div id="deploy-info">Loading...</div>
  </section>
  <section id="agents">
    <h2>Agents</h2>
    <ul id="agent-list"></ul>
  </section>
  <section id="qa">
    <h2>QA Results</h2>
    <pre id="qa-results">Loading...</pre>
  </section>
  <button id="run-postdeploy">Run Post-Deploy Checks</button>
  <button id="refresh">Refresh</button>
<script>
async function fetchSummary() {
  const res = await fetch('/api/summary');
  const data = await res.json();
  const deploy = data.deployment || {};
  document.getElementById('deploy-info').textContent = deploy.commit
    ? `Commit ${deploy.commit} at ${deploy.timestamp} - ${deploy.status || ''}`
    : 'No deployment data';
  const list = document.getElementById('agent-list');
  list.innerHTML = '';
  const agents = data.agents || {};
  for (const key in agents) {
    const meta = agents[key];
    const li = document.createElement('li');
    li.textContent = `${meta.name} - ${meta.description}`;
    list.appendChild(li);
  }
  document.getElementById('qa-results').textContent = data.qa
    ? JSON.stringify(data.qa.result || data.qa, null, 2)
    : 'No QA results';
}

document.getElementById('run-postdeploy').onclick = async () => {
  await fetch('/api/run-postdeploy', { method: 'POST' });
  setTimeout(fetchSummary, 1000);
};

document.getElementById('refresh').onclick = fetchSummary;

fetchSummary();
</script>
</body>
</html>
